# Лабораторная работа №3: Линейные модели. Кросс-валидация. Вариант 17



# 1. Разделение данных на выборки

Данные набора `College_for_lab` успешно разделены на обучающую (80%) и тестовую (20%) выборки с использованием random_state=17. Из исходного набора оставлены только переменные варианта 17: зависимая переменная `Grad_Rate` и объясняющие переменные `Accept`, `Top10perc`, `Private`. Фиктивная переменная `Private` преобразована в числовой формат (1 - частный, 0 - государственный). Обучающая выборка содержит 621 наблюдение, тестовая - 156 наблюдений. Отложенные наблюдения сохранены для задания 6.

# 2. Предварительный анализ данных

Описательные статистики показали, что выпускной балл варьируется от 15 до 118 со средним значением 65.3. Количество принятых заявок имеет большой разброс - от 81 до 26330, что указывает на существенные различия в размерах университетов. Доля студентов из топ-10% составляет в среднем 27.6%.

Матричные графики разброса выявили четкую положительную зависимость между `Grad_Rate` и `Top10perc` - университеты с большим процентом сильных абитуриентов демонстрируют более высокие выпускные баллы. Связь между `Grad_Rate` и `Accept` выражена слабее. На графиках с раскраской по типу университета видно, что частные вузы (Private=1) концентрируются в области более высоких значений `Grad_Rate` и `Top10perc`.

Корреляционный анализ подтвердил визуальные наблюдения: наибольшая корреляция 0.41 между `Grad_Rate` и `Top10perc`, слабая корреляция 0.10 между `Grad_Rate` и `Accept`.

# 3. Проверка нормальности распределения

Тест Шапиро-Уилка показал, что распределение `Grad_Rate` не является нормальным (p=0.0000). После логарифмирования распределение `log_Grad_Rate` также формально не соответствует нормальному (p=0.0000), однако на гистограмме видно улучшение формы распределения. Матричные графики для логарифмированной переменной показали сохранение основных взаимосвязей, но с изменением характера некоторых зависимостей.

# 4. Спецификации моделей множественной регрессии

Разработано 10 моделей:
Для Grad_Rate**: 5 моделей от базовой (все объясняющие) до моделей с взаимодействиями `Accept:Private` и `Top10perc:Private`
Для log(Grad_Rate)**: 5 аналогичных моделей с логарифмированной зависимой переменной

Модели включают различные комбинации переменных и их взаимодействий для исследования сложных взаимосвязей.

# 5. Оценка параметров и кросс-валидация

Параметры моделей оценены на обучающей выборке. Например, модель `fit_lm_0` имеет константу 52.321 и коэффициенты [0.000, 0.426, 5.661] для переменных `Accept`, `Top10perc`, `Private` соответственно.

Кросс-валидация K-Fold (10 блоков) проведена для всех моделей. Результаты показали:
- Самая точная модель для `Grad_Rate`: `fit_lm_2` (с взаимодействием `Accept:Private`)
- Самая точная модель для `log(Grad_Rate)`: `fit_lm_0_log` (базовая модель с логарифмированной зависимой переменной)

# 6. Прогноз на отложенные наблюдения и финальный выбор

Прогноз на тестовой выборке показал:
- MSE модели `fit_lm_2` = 157.69
- MSE модели `fit_lm_0_log` = 165.42

Финальная лучшая модель: `fit_lm_2` с MSE 157.69

Интерпретация параметров модели `fit_lm_2`:
- Константа 56.792 - базовый уровень выпускного балла при нулевых значениях объясняющих переменных
- Коэффициент 0.423 при `Top10perc` - увеличение доли студентов из топ-10% на 1% приводит к росту выпускного балла на 0.423 пункта
- Коэффициент 5.537 при `Private` - частные университеты имеют выпускной балл на 5.537 пунктов выше государственных при прочих равных условиях
- Коэффициент -0.000 при `Accept_Private` - взаимодействие между количеством заявок и типом университета статистически незначимо

Модель демонстрирует, что наиболее значимыми факторами успешности университета являются качество поступающих студентов (Top10perc) и организационно-правовая форма (Private), в то время как размер университета (Accept) и его взаимодействие с типом не оказывают существенного влияния на выпускные баллы.