# Лабораторная работа №4
## Методы снижения размерности. Регуляризация логистической регрессии.
### Вариант 17

### Описание работы
В данной лабораторной работе проводится анализ данных кредитного скоринга с применением методов снижения размерности и регуляризации. Основная задача - классификация клиентов на тех, кто выполнит обязательства по кредиту, и тех, кто допустит дефолт.

### Используемые данные
Набор данных: Default of Credit Card Clients
Целевая переменная: Y (дефолт по кредиту)

Согласно варианту 17, из анализа исключены следующие переменные:
- PAY_4, PAY_5, PAY_6
- BILL_AMT4, BILL_AMT5, BILL_AMT6
- PAY_AMT1, PAY_AMT2, PAY_AMT3, PAY_AMT4, PAY_AMT5, PAY_AMT6

### Методы исследования

#### Снижение размерности
- **PCR (Principal Component Regression)** - регрессия на главных компонентах
- Количество компонент выбрано на основе анализа объясненной дисперсии (80% дисперсии)

#### Регуляризация
- **Ридж-регрессия (L2-регуляризация)** - метод сжатия коэффициентов
- Оптимальный параметр C подобран с помощью перекрестной проверки

#### Оценка качества моделей
- Перекрестная проверка по 10 блокам
- Метрики: Accuracy, Precision, Recall, F1-score
- Матрица ошибок для визуализации результатов классификации

### Основные этапы работы

1. **Загрузка и подготовка данных**
   - Загрузка данных из репозитория
   - Фильтрация переменных согласно варианту
   - Проверка данных на пропущенные значения

2. **Разделение данных**
   - Обучающая выборка: 85% наблюдений
   - Тестовая выборка: 15% наблюдений
   - Сохранение распределения классов в обеих выборках

3. **Предварительный анализ**
   - Расчет описательных статистик
   - Анализ распределения целевой переменной
   - Исследование основных характеристик признаков

4. **Корреляционный анализ**
   - Построение матрицы корреляций
   - Выявление статистически значимых взаимосвязей
   - Визуализация результатов с помощью тепловой карты

5. **Стандартизация данных**
   - Приведение всех признаков к единому масштабу
   - Проверка корректности стандартизации

6. **Регрессия на главных компонентах (PCR)**
   - Анализ объясненной дисперсии компонент
   - Выбор оптимального числа главных компонент
   - Построение и оценка модели логистической регрессии

7. **Ридж-регрессия**
   - Подбор оптимального параметра регуляризации C
   - Построение графиков сжатия коэффициентов
   - Оценка точности модели с L2-регуляризацией

8. **Сравнение моделей и выбор лучшей**
   - Сравнение точности PCR и ридж-регрессии
   - Выбор модели с наилучшими показателями

9. **Прогноз на тестовых данных**
   - Оценка обобщающей способности лучшей модели
   - Построение матрицы ошибок
   - Анализ метрик качества на отложенной выборке

10. **Визуализация результатов**
    - Графическое представление матрицы ошибок
    - Сравнительная диаграмма точности моделей

### Ключевые результаты

После выполнения всех этапов работы получены следующие результаты:

- Точность модели на главных компонентах (PCR): 0.804
- Точность ридж-регрессии: 0.810
- Лучшая модель: Ridge
- Точность на тестовой выборке: 0.809