Лабораторная работа №5 Осадиной Дарьи ПМИ 3-1: Методы, основанные на деревьях решений

Цель работы: Исследование методов машинного обучения, основанных на деревьях решений для задачи классификации.

Задание: Построить и сравнить модели классификации на основе деревьев решений для задачи рекомендации купонов в транспортных средствах.

Набор данных: in-vehicle-coupon-recommendation.csv
Источник: Калифорнийский университет в Ирвине
Размер исходных данных: 12684 наблюдения, 26 признаков
Целевая переменная: Y (бинарная: принятие/отказ купона)

Задача 1: Разделение данных
- Данные разделены на обучающую выборку (85%) и отложенные наблюдения (15%)
- Отложенные наблюдения использованы только для финального прогноза по лучшей модели
- Обучающая выборка: 25500 строк
- Отложенная выборка: 4500 строк

Задача 2: Дерево с обрезкой ветвей
- Построена модель дерева с обрезкой ветвей
- Параметр α оптимизирован с помощью перекрёстной проверки
- Оптимальное значение alpha: 0.000060
- Точность на тестовой выборке: 0.726
- Количество узлов оптимального дерева: 5795
- Глубина оптимального дерева: 41
- Точность с перекрёстной проверкой: 0.730 (+/- 0.003)

Задача 3: Случайный лес (вариант 17)
- Построена модель случайного леса
- Параметры оптимизированы с помощью сеточного поиска
- Использовано 7+ значений для каждого параметра:
  - n_estimators: 7 значений (50, 100, 150, 200, 250, 300, 350)
  - max_features: 7 значений (0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7)
  - max_depth: 7 значений (5, 10, 15, 20, 25, 30, None)
- Оптимальные параметры:
  - n_estimators: 350
  - max_features: 0.7
  - max_depth: 20
- Точность с перекрёстной проверкой: 0.754

Задача 4: Выбор наиболее точной модели
- ТОЧНОСТЬ МОДЕЛЕЙ (перекрёстная проверка):
  Дерево с обрезкой: 0.683 (+/- 0.004)
  Случайный лес: 0.754 (+/- 0.003)
- ЛУЧШАЯ МОДЕЛЬ: Случайный лес

Задача 5: Прогноз на отложенные наблюдения
- Выполнен прогноз лучшей моделью (Случайный лес) на отложенные данные
- Точность прогноза: 0.767
- Построена матрица ошибок
- Сформирован подробный отчёт по классификации

Задача 6: Сравнение с упражнением 4
- Точность на отложенных наблюдениях: 0.767

Технические детали реализации

Используемые библиотеки
- numpy, pandas - работа с данными
- matplotlib, seaborn - визуализация
- scikit-learn - модели машинного обучения
- scipy - статистические тесты

Параметры выполнения
- Вариант: 17 (Случайный лес)
- Зерно ГСЧ: 17
- Количество блоков перекрёстной проверки: 5
- Количество значений параметров для сеточного поиска: 7+

Ключевые результаты

Сравнение точности моделей:
- Дерево с обрезкой: 0.683
- Случайный лес: 0.754

Лучшая модель: Случайный лес
Точность на отложенных данных: 0.767